<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en" data-bs-theme="auto"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>Foundations of Astronomical Data Science: Plotting and Pandas</title><meta name="viewport" content="width=device-width, initial-scale=1"><script src="assets/themetoggle.js"></script><link rel="stylesheet" type="text/css" href="assets/styles.css"><script src="assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="favicons/dc/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="favicons/dc/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="favicons/dc/favicon-16x16.png"><link rel="manifest" href="favicons/dc/site.webmanifest"><link rel="mask-icon" href="favicons/dc/safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="black"></head><body>
    <header id="top" class="navbar navbar-expand-md top-nav data"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewbox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"></path></symbol><symbol id="circle-half" viewbox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"></path></symbol><symbol id="moon-stars-fill" viewbox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></symbol><symbol id="sun-fill" viewbox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></symbol></svg><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-8">
      <div class="large-logo">
        <img id="dc-logo" alt="Data Carpentry" src="assets/images/data-logo.svg"></div>
    </div>
    <div class="selector-container">
      <div id="theme-selector">
        <li class="nav-item dropdown" id="theme-button-list">
          <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
            <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text"><li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                Light
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                Dark
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                Auto
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
          </ul></li>
      </div>

      <div class="dropdown" id="instructor-dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Learner View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li><button class="dropdown-item" type="button" onclick="window.location.href='instructor/04-motion.html';">Instructor View</button></li>
        </ul></div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl bottom-nav data" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Data Carpentry" src="assets/images/data-logo-sm.svg"></div>
    <div class="lesson-title-md">
      Foundations of Astronomical Data Science
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item">
          <span class="lesson-title">
            Foundations of Astronomical Data Science
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="reference.html#glossary">Glossary</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="profiles.html">Learner Profiles</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"><li><a class="dropdown-item" href="discuss.html">Discussion</a></li><li><a class="dropdown-item" href="reference.html">Reference</a></li>
          </ul></li>
      </ul></div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a id="search-button" class="btn btn-primary" href="aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div><!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Foundations of Astronomical Data Science
</div>

<aside class="col-md-12 lesson-progress"><div style="width: 38%" class="percentage">
    38%
  </div>
  <div class="progress data">
    <div class="progress-bar data" role="progressbar" style="width: 38%" aria-valuenow="38" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row" id="theme-row-mobile">
            <div class="col" id="theme-selector">
              <li class="nav-item dropdown" id="theme-button-list">
                <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
                  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><span class="d-lg-none ms-1" id="bd-theme-text">Toggle Theme</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-theme-text"><li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                      Light
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                      Dark
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                      <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                      Auto
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                </ul></li>
            </div>
          </div>
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Learner View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="instructor/04-motion.html">Instructor View</a>
                      </div>
                    </div>
                  </div><!--/div.accordion-item-->
                </div><!--/div.accordion-flush-->
              </div><!--div.sidenav-view-selector -->
            </div><!--/div.col -->

            <hr></div><!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Setup</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="01-query.html">1. Basic Queries</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="02-coords.html">2. Coordinate Transformations</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="03-transform.html">3. Plotting and Tabular Data</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlushcurrent">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-headingcurrent">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapsecurrent" aria-expanded="true" aria-controls="flush-collapsecurrent">
        <span class="visually-hidden">Current Chapter</span>
        <span class="current-chapter">
        4. Plotting and Pandas
        </span>
      </button>
    </div><!--/div.accordion-header-->

    <div id="flush-collapsecurrent" class="accordion-collapse collapse show" aria-labelledby="flush-headingcurrent" data-bs-parent="#accordionFlushcurrent">
      <div class="accordion-body">
        <ul><li><a href="#exploring-data">Exploring data</a></li>
<li><a href="#plot-proper-motion">Plot proper motion</a></li>
<li><a href="#selecting-the-centerline">Selecting the centerline</a></li>
<li><a href="#plotting-proper-motion">Plotting proper motion</a></li>
<li><a href="#filtering-based-on-proper-motion">Filtering based on proper motion</a></li>
<li><a href="#saving-the-dataframe">Saving the DataFrame</a></li>
<li><a href="#summary">Summary</a></li>
        </ul></div><!--/div.accordion-body-->
    </div><!--/div.accordion-collapse-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="05-select.html">5. Transform and Select</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="06-join.html">6. Join</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="07-photo.html">7. Photometry</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush9">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading9">
        <a href="08-plot.html">8. Visualization</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width"><div class="accordion accordion-flush lesson-resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="lesson-resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul><li>
                        <a href="key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="reference.html#glossary">Glossary</a>
                      </li>
                      <li>
                        <a href="profiles.html">Learner Profiles</a>
                      </li>
                      <li><a href="discuss.html">Discussion</a></li><li><a href="reference.html">Reference</a></li>
                    </ul></div>
                </div>
              </div>
            </div>
            <hr class="half-width lesson-resources"><a href="aio.html">See all in one page</a>


            <hr class="d-none d-sm-block d-md-none"><div class="d-grid gap-1">

            </div>
          </div><!-- /div.accordion -->
        </div><!-- /div.sidebar-inner -->
      </nav></div><!-- /div.sidebar -->
  </div><!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-instructor.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <nav class="lesson-content mx-md-4" aria-label="Previous and Next Chapter"><!-- content for small screens --><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="03-transform.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="05-select.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="03-transform.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Plotting and Tabular
        </a>
        <a class="chapter-link float-end" href="05-select.html" rel="next">
          Next: Transform and Select...
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
      <hr></nav><main id="main-content" class="main-content"><div class="container lesson-content">
        <h1>Plotting and Pandas</h1>
        <p>Last updated on 2024-03-08 |

        <a href="https://github.com/datacarpentry/astronomy-python/edit/main/episodes/04-motion.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>



        <div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>

        

<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul><li>How do efficiently explore our data and identify appropriate filters
to produce a clean sample (in this case of GD-1 stars)?</li>
</ul></div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul><li>Use a Boolean Pandas <code>Series</code> to select rows in a
<code>DataFrame</code>.</li>
<li>Save multiple <code>DataFrame</code>s in an HDF5 file.</li>
</ul></div>
</div>
</div>
</div>
</div>
<p>In the previous episode, we wrote a query to select stars from the
region of the sky where we expect GD-1 to be, and saved the results in a
FITS and HDF5 file.</p>
<p>Now we will read that data back in and implement the next step in the
analysis, identifying stars with the proper motion we expect for
GD-1.</p>
<div id="outline" class="callout checklist">
<div class="callout-square">
<i class="callout-icon" data-feather="check-square"></i>
</div>
<div id="outline" class="callout-inner">
<h3 class="callout-title">Outline</h3>
<div class="callout-content">
<ol style="list-style-type: decimal"><li><p>We will put those results into a Pandas <code>DataFrame</code>,
which we will use to select stars near the centerline of GD-1.</p></li>
<li><p>Plotting the proper motion of those stars, we will identify a
region of proper motion for stars that are likely to be in
GD-1.</p></li>
<li><p>Finally, we will select and plot the stars whose proper motion is
in that region.</p></li>
</ol></div>
</div>
</div>
<div id="starting-from-this-episode" class="callout prereq">
<div class="callout-square">
<i class="callout-icon" data-feather="check"></i>
</div>
<div id="starting-from-this-episode" class="callout-inner">
<h3 class="callout-title">Starting from this episode</h3>
<div class="callout-content">
<p>If you are starting a new notebook for this episode, expand this
section for information you will need to get started.</p>
<div id="accordionSpoiler1" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler1" aria-expanded="false" aria-controls="collapseSpoiler1">
  <h3 class="accordion-header" id="headingSpoiler1">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Read me </h3>
</button>
<div id="collapseSpoiler1" class="accordion-collapse collapse" aria-labelledby="headingSpoiler1" data-bs-parent="#accordionSpoiler1">
<div class="accordion-body">
<p>Previously, we ran a query on the Gaia server, downloaded data for
roughly 140,000 stars, transformed the coordinates to the GD-1 reference
frame, and saved the results in an HDF5 file (Dataset name
<code>results_df</code>). We will use that data for this episode.
Whether you are working from a new notebook or coming back from a
checkpoint, reloading the data will save you from having to run the
query again.</p>
<p>If you are starting this episode here or starting this episode in a
new notebook, you will need to run the following lines of code.</p>
<p>This imports previously imported functions:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="im">import</span> astropy.units <span class="im">as</span> u</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="im">from</span> episode_functions <span class="im">import</span> <span class="op">*</span></span></code></pre>
</div>
<p>The following code loads in the data (instructions for downloading
data can be found in the <a href="index.html#setup">setup instructions</a>).
You may need to add a the path to the filename variable below
(e.g. <code>filename = 'student_download/backup-data/gd1_data.hdf'</code>)</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>filename <span class="op">=</span> <span class="st">'gd1_data.hdf'</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>results_df <span class="op">=</span> pd.read_hdf(filename, <span class="st">'results_df'</span>)</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="exploring-data">Exploring data<a class="anchor" aria-label="anchor" href="#exploring-data"></a></h2>
<hr class="half-width"><p>One benefit of using Pandas is that it provides functions for
exploring the data and checking for problems. One of the most useful of
these functions is <code>describe</code>, which computes summary
statistics for each column.</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>results_df.describe()</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>          source_id             ra            dec           pmra  \
count  1.403390e+05  140339.000000  140339.000000  140339.000000
mean   6.792399e+17     143.823122      26.780285      -2.484404
std    3.792177e+16       3.697850       3.052592       5.913939
min    6.214900e+17     135.425699      19.286617    -106.755260
25%    6.443517e+17     140.967966      24.592490      -5.038789
50%    6.888060e+17     143.734409      26.746261      -1.834943
75%    6.976579e+17     146.607350      28.990500       0.452893
max    7.974418e+17     152.777393      34.285481     104.319923

               pmdec       parallax           phi1           phi2  \
[Output truncated]</code></pre>
</div>
<div id="exercise-10-minutes" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-10-minutes" class="callout-inner">
<h3 class="callout-title">Exercise (10 minutes)</h3>
<div class="callout-content">
<p>Review the summary statistics in this table.</p>
<ul><li><p>Do the values make sense based on what you know about the
context?</p></li>
<li><p>Do you see any values that seem problematic, or evidence of other
data issues?</p></li>
</ul></div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p>The most noticeable issue is that some of the parallax values are
negative, which seems non-physical.</p>
<p>Negative parallaxes in the Gaia database can arise from a number of
causes like source confusion (high negative values) and the parallax
zero point with systematic errors (low negative values).</p>
<p>Fortunately, we do not use the parallax measurements in the analysis
(one of the reasons we used constant distance for reflex
correction).</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="plot-proper-motion">Plot proper motion<a class="anchor" aria-label="anchor" href="#plot-proper-motion"></a></h2>
<hr class="half-width"><p>Now we are ready to replicate one of the panels in Figure 1 of the
Price-Whelan and Bonaca paper, the one that shows components of proper
motion as a scatter plot:</p>
<figure><img width="300" src="fig/gd1-1.png" alt="Scatter of proper motion phi1 versus phi2 showing overdensity in negative proper motions of GD-1 stars." class="figure mx-auto d-block"></figure><p>In this figure, the shaded area identifies stars that are likely to
be in GD-1 because:</p>
<ul><li><p>Due to the nature of tidal streams, we expect the proper motion
for stars in GD-1 to be along the axis of the stream; that is, we expect
motion in the direction of <code>phi2</code> to be near 0.</p></li>
<li><p>In the direction of <code>phi1</code>, we do not have a prior
expectation for proper motion, except that it should form a cluster at a
non-zero value.</p></li>
</ul><p>By plotting proper motion in the GD-1 frame, we hope to find this
cluster. Then we will use the bounds of the cluster to select stars that
are more likely to be in GD-1.</p>
<p>The following figure is a scatter plot of proper motion, in the GD-1
frame, for the stars in <code>results_df</code>.</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>x <span class="op">=</span> results_df[<span class="st">'pm_phi1'</span>]</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>y <span class="op">=</span> results_df[<span class="st">'pm_phi2'</span>]</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>plt.plot(x, y, <span class="st">'ko'</span>, markersize<span class="op">=</span><span class="fl">0.1</span>, alpha<span class="op">=</span><span class="fl">0.1</span>)</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>    </span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>plt.xlabel(<span class="st">'Proper motion phi1 (mas/yr GD1 frame)'</span>)</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>plt.ylabel(<span class="st">'Proper motion phi2 (mas/yr GD1 frame)'</span>)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>&lt;Figure size 432x288 with 1 Axes&gt;</code></pre>
</div>
<figure><img src="fig/04-motion_files/04-motion_67_0.png" alt="Scatter plot of proper motion in GD-1 frame of selected stars showing most are near the origin." class="figure mx-auto d-block"></figure><p>Most of the proper motions are near the origin, but there are a few
extreme values. Following the example in the paper, we will use
<code>xlim</code> and <code>ylim</code> to zoom in on the region near
the origin.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>x <span class="op">=</span> results_df[<span class="st">'pm_phi1'</span>]</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>y <span class="op">=</span> results_df[<span class="st">'pm_phi2'</span>]</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>plt.plot(x, y, <span class="st">'ko'</span>, markersize<span class="op">=</span><span class="fl">0.1</span>, alpha<span class="op">=</span><span class="fl">0.1</span>)</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>    </span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>plt.xlabel(<span class="st">'Proper motion phi1 (mas/yr GD1 frame)'</span>)</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>plt.ylabel(<span class="st">'Proper motion phi2 (mas/yr GD1 frame)'</span>)</span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a>plt.xlim(<span class="op">-</span><span class="dv">12</span>, <span class="dv">8</span>)</span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a>plt.ylim(<span class="op">-</span><span class="dv">10</span>, <span class="dv">10</span>)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>&lt;Figure size 432x288 with 1 Axes&gt;</code></pre>
</div>
<figure><img src="fig/04-motion_files/04-motion_69_0.png" alt="Zoomed in view of previous scatter plot showing overdense region." class="figure mx-auto d-block"></figure><p>There is a hint of an overdense region near (-7.5, 0), but if you did
not know where to look, you would miss it.</p>
<p>To see the cluster more clearly, we need a sample that contains a
higher proportion of stars in GD-1. We will do that by selecting stars
close to the centerline.</p>
</section><section><h2 class="section-heading" id="selecting-the-centerline">Selecting the centerline<a class="anchor" aria-label="anchor" href="#selecting-the-centerline"></a></h2>
<hr class="half-width"><p>As we can see in the following figure, many stars in GD-1 are less
than 1 degree from the line <code>phi2=0</code>.</p>
<figure><img src="fig/gd1-4.png" alt="Scatter plot with selection on proper motion and photometry showing many stars in GD-1 are within 1 degree of phi2 = 0." class="figure mx-auto d-block"></figure><p>Stars near this line have the highest probability of being in
GD-1.</p>
<p>To select them, we will use a “Boolean mask”. We will start by
selecting the <code>phi2</code> column from the
<code>DataFrame</code>:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>phi2 <span class="op">=</span> results_df[<span class="st">'phi2'</span>]</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="bu">type</span>(phi2)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">pandas.core.series.Series</span></span></code></pre>
</div>
<p>The result is a <code>Series</code>, which is the structure Pandas
uses to represent columns.</p>
<p>We can use a comparison operator, <code>&gt;</code>, to compare the
values in a <code>Series</code> to a constant.</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>phi2_min <span class="op">=</span> <span class="op">-</span><span class="fl">1.0</span> <span class="op">*</span> u.degree</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>phi2_max <span class="op">=</span> <span class="fl">1.0</span> <span class="op">*</span> u.degree</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>mask <span class="op">=</span> (phi2 <span class="op">&gt;</span> phi2_min)</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="bu">type</span>(mask)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">pandas.core.series.Series</span></span></code></pre>
</div>
<p>The result is a <code>Series</code> of Boolean values, that is,
<code>True</code> and <code>False</code>.</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>mask.head()</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>0    False
1    False
2    False
3    False
4    False
Name: phi2, dtype: bool</code></pre>
</div>
<p>To select values that fall between <code>phi2_min</code> and
<code>phi2_max</code>, we will use the <code>&amp;</code> operator,
which computes “logical AND”. The result is true where elements from
both Boolean <code>Series</code> are true.</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>mask <span class="op">=</span> (phi2 <span class="op">&gt;</span> phi2_min) <span class="op">&amp;</span> (phi2 <span class="op">&lt;</span> phi2_max)</span></code></pre>
</div>
<div id="logical-operators" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="logical-operators" class="callout-inner">
<h3 class="callout-title">Logical operators</h3>
<div class="callout-content">
<p>Python’s logical operators (<code>and</code>, <code>or</code>, and
<code>not</code>) do not work with NumPy or Pandas. Both libraries use
the bitwise operators (<code>&amp;</code>, <code>|</code>, and
<code>~</code>) to do elementwise logical operations (<a href="https://stackoverflow.com/questions/21415661/logical-operators-for-boolean-indexing-in-pandas" class="external-link">explanation
here</a>).</p>
<p>Also, we need the parentheses around the conditions; otherwise the
order of operations is incorrect.</p>
</div>
</div>
</div>
<p>The sum of a Boolean <code>Series</code> is the number of
<code>True</code> values, so we can use <code>sum</code> to see how many
stars are in the selected region.</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>mask.<span class="bu">sum</span>()</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fl">25084</span></span></code></pre>
</div>
<p>A Boolean <code>Series</code> is sometimes called a “mask” because we
can use it to mask out some of the rows in a <code>DataFrame</code> and
select the rest, like this:</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>centerline_df <span class="op">=</span> results_df[mask]</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a><span class="bu">type</span>(centerline_df)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">pandas.core.frame.DataFrame</span></span></code></pre>
</div>
<p><code>centerline_df</code> is a <code>DataFrame</code> that contains
only the rows from <code>results_df</code> that correspond to
<code>True</code> values in <code>mask</code>. So it contains the stars
near the centerline of GD-1.</p>
<p>We can use <code>len</code> to see how many rows are in
<code>centerline_df</code>:</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="bu">len</span>(centerline_df)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fl">25084</span></span></code></pre>
</div>
<p>And what fraction of the rows we have selected.</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="bu">len</span>(centerline_df) <span class="op">/</span> <span class="bu">len</span>(results_df)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fl">0.1787386257562046</span></span></code></pre>
</div>
<p>There are about 25,000 stars in this region, about 18% of the
total.</p>
</section><section><h2 class="section-heading" id="plotting-proper-motion">Plotting proper motion<a class="anchor" aria-label="anchor" href="#plotting-proper-motion"></a></h2>
<hr class="half-width"><p>This is the second time we are plotting proper motion, and we can
imagine we might do it a few more times. Instead of copying and pasting
the previous code, we will write a function that we can reuse on any
dataframe.</p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="kw">def</span> plot_proper_motion(df):</span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a>    <span class="co">"""Plot proper motion.</span></span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a><span class="co">    df: DataFrame with `pm_phi1` and `pm_phi2`</span></span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a>    x <span class="op">=</span> df[<span class="st">'pm_phi1'</span>]</span>
<span id="cb24-7"><a href="#cb24-7" tabindex="-1"></a>    y <span class="op">=</span> df[<span class="st">'pm_phi2'</span>]</span>
<span id="cb24-8"><a href="#cb24-8" tabindex="-1"></a>    plt.plot(x, y, <span class="st">'ko'</span>, markersize<span class="op">=</span><span class="fl">0.3</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb24-9"><a href="#cb24-9" tabindex="-1"></a></span>
<span id="cb24-10"><a href="#cb24-10" tabindex="-1"></a>    plt.xlabel(<span class="st">'Proper motion phi1 (mas/yr)'</span>)</span>
<span id="cb24-11"><a href="#cb24-11" tabindex="-1"></a>    plt.ylabel(<span class="st">'Proper motion phi2 (mas/yr)'</span>)</span>
<span id="cb24-12"><a href="#cb24-12" tabindex="-1"></a></span>
<span id="cb24-13"><a href="#cb24-13" tabindex="-1"></a>    plt.xlim(<span class="op">-</span><span class="dv">12</span>, <span class="dv">8</span>)</span>
<span id="cb24-14"><a href="#cb24-14" tabindex="-1"></a>    plt.ylim(<span class="op">-</span><span class="dv">10</span>, <span class="dv">10</span>)</span></code></pre>
</div>
<p>And we can call it like this:</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>plot_proper_motion(centerline_df)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>&lt;Figure size 432x288 with 1 Axes&gt;</code></pre>
</div>
<figure><img src="fig/04-motion_files/04-motion_92_0.png" alt="Scatter plot of proper motion of selected stars showing cluster near (-7.5, 0)." class="figure mx-auto d-block"></figure><p>Now we can see more clearly that there is a cluster near (-7.5,
0).</p>
<p>You might notice that our figure is less dense than the one in the
paper. That is because we started with a set of stars from a relatively
small region. The figure in the paper is based on a region about 10
times bigger.</p>
<p>In the next episode we will go back and select stars from a larger
region. But first we will use the proper motion data to identify stars
likely to be in GD-1.</p>
</section><section><h2 class="section-heading" id="filtering-based-on-proper-motion">Filtering based on proper motion<a class="anchor" aria-label="anchor" href="#filtering-based-on-proper-motion"></a></h2>
<hr class="half-width"><p>The next step is to select stars in the “overdense” region of proper
motion, which are candidates to be in GD-1.</p>
<p>In the original paper, Price-Whelan and Bonaca used a polygon to
cover this region, as shown in this figure.</p>
<figure><img width="300" src="fig/gd1-1.png" alt="Scatter plot of proper motion with overlaid polygon showing overdense region selected for analysis in Price-Whelan and Bonaca paper." class="figure mx-auto d-block"></figure><p>We will use a simple rectangle for now, but in a later lesson we will
see how to select a polygonal region as well.</p>
<p>Here are bounds on proper motion we chose by eye:</p>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a>pm1_min <span class="op">=</span> <span class="op">-</span><span class="fl">8.9</span></span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a>pm1_max <span class="op">=</span> <span class="op">-</span><span class="fl">6.9</span></span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a>pm2_min <span class="op">=</span> <span class="op">-</span><span class="fl">2.2</span></span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a>pm2_max <span class="op">=</span>  <span class="fl">1.0</span></span></code></pre>
</div>
<p>To draw these bounds, we will use the <code>make_rectangle</code>
function we wrote in episode 2 to make two lists containing the
coordinates of the corners of the rectangle.</p>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a>pm1_rect, pm2_rect <span class="op">=</span> make_rectangle(</span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a>    pm1_min, pm1_max, pm2_min, pm2_max)</span></code></pre>
</div>
<p>Here is what the plot looks like with the bounds we chose.</p>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a>plot_proper_motion(centerline_df)</span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a>plt.plot(pm1_rect, pm2_rect, <span class="st">'-'</span>)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>&lt;Figure size 432x288 with 1 Axes&gt;</code></pre>
</div>
<figure><img src="fig/04-motion_files/04-motion_100_0.png" alt="Scatter plot of proper motion with blue box showing overdense region selected for our analysis." class="figure mx-auto d-block"></figure><p>Now that we have identified the bounds of the cluster in proper
motion, we will use it to select rows from <code>results_df</code>.</p>
<p>We will use the following function, which uses Pandas operators to
make a mask that selects rows where <code>series</code> falls between
<code>low</code> and <code>high</code>.</p>
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="kw">def</span> between(series, low, high):</span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a>    <span class="co">"""Check whether values are between `low` and `high`."""</span></span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a>    <span class="cf">return</span> (series <span class="op">&gt;</span> low) <span class="op">&amp;</span> (series <span class="op">&lt;</span> high)</span></code></pre>
</div>
<p>The following mask selects stars with proper motion in the region we
chose.</p>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a>pm1 <span class="op">=</span> results_df[<span class="st">'pm_phi1'</span>]</span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a>pm2 <span class="op">=</span> results_df[<span class="st">'pm_phi2'</span>]</span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a>pm_mask <span class="op">=</span> (between(pm1, pm1_min, pm1_max) <span class="op">&amp;</span> </span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a>           between(pm2, pm2_min, pm2_max))</span></code></pre>
</div>
<p>Again, the sum of a Boolean series is the number of <code>TRUE</code>
values.</p>
<div class="codewrapper sourceCode" id="cb33">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a>pm_mask.<span class="bu">sum</span>()</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fl">1049</span></span></code></pre>
</div>
<p>Now we can use this mask to select rows from
<code>results_df</code>.</p>
<div class="codewrapper sourceCode" id="cb35">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a>selected_df <span class="op">=</span> results_df[pm_mask]</span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a><span class="bu">len</span>(selected_df)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fl">1049</span></span></code></pre>
</div>
<p>These are the stars we think are likely to be in GD-1. We can inspect
these stars, plotting their coordinates (not their proper motion).</p>
<div class="codewrapper sourceCode" id="cb37">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a>x <span class="op">=</span> selected_df[<span class="st">'phi1'</span>]</span>
<span id="cb37-2"><a href="#cb37-2" tabindex="-1"></a>y <span class="op">=</span> selected_df[<span class="st">'phi2'</span>]</span>
<span id="cb37-3"><a href="#cb37-3" tabindex="-1"></a>plt.plot(x, y, <span class="st">'ko'</span>, markersize<span class="op">=</span><span class="dv">1</span>, alpha<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb37-4"><a href="#cb37-4" tabindex="-1"></a></span>
<span id="cb37-5"><a href="#cb37-5" tabindex="-1"></a>plt.xlabel(<span class="st">'phi1 (degree GD1)'</span>)</span>
<span id="cb37-6"><a href="#cb37-6" tabindex="-1"></a>plt.ylabel(<span class="st">'phi2 (degree GD1)'</span>)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>&lt;Figure size 432x288 with 1 Axes&gt;</code></pre>
</div>
<figure><img src="fig/04-motion_files/04-motion_110_0.png" alt="Scatter plot of coordinates of stars in selected region, showing tidal stream." class="figure mx-auto d-block"></figure><p>Now that is starting to look like a tidal stream!</p>
<p>To clean up the plot a little bit we can add two new Matplotlib
commands:</p>
<ul><li><p><code>axis</code> with the parameter <code>equal</code> sets up
the axes so a unit is the same size along the <code>x</code> and
<code>y</code> axes.</p></li>
<li><p><code>title</code> puts the input string as a title at the top of
the plot. The <code>fontsize</code> keyword sets the
<code>fontsize</code> to be <code>medium</code>, a little smaller than
the default <code>large</code>.</p></li>
</ul><p>In an example like this, where <code>x</code> and <code>y</code>
represent coordinates in space, equal axes ensures that the distance
between points is represented accurately. Since we are now constraining
the relative proportions of our axes, the data may not fill the entire
figure.</p>
<div class="codewrapper sourceCode" id="cb39">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a>x <span class="op">=</span> selected_df[<span class="st">'phi1'</span>]</span>
<span id="cb39-2"><a href="#cb39-2" tabindex="-1"></a>y <span class="op">=</span> selected_df[<span class="st">'phi2'</span>]</span>
<span id="cb39-3"><a href="#cb39-3" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" tabindex="-1"></a>plt.plot(x, y, <span class="st">'ko'</span>, markersize<span class="op">=</span><span class="fl">0.3</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb39-5"><a href="#cb39-5" tabindex="-1"></a></span>
<span id="cb39-6"><a href="#cb39-6" tabindex="-1"></a>plt.xlabel(<span class="st">'phi1 [deg]'</span>)</span>
<span id="cb39-7"><a href="#cb39-7" tabindex="-1"></a>plt.ylabel(<span class="st">'phi2 [deg]'</span>)</span>
<span id="cb39-8"><a href="#cb39-8" tabindex="-1"></a>plt.title(<span class="st">'Proper motion selection'</span>, fontsize<span class="op">=</span><span class="st">'medium'</span>)</span>
<span id="cb39-9"><a href="#cb39-9" tabindex="-1"></a></span>
<span id="cb39-10"><a href="#cb39-10" tabindex="-1"></a>plt.axis(<span class="st">'equal'</span>)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>&lt;Figure size 432x288 with 1 Axes&gt;</code></pre>
</div>
<figure><img src="fig/04-motion_files/04-motion_plot_pm_selection.png" alt="Scatter plot of coordinates of stars in selected region, showing tidal stream with equally proportioned axes." class="figure mx-auto d-block"></figure><p>Before we go any further, we will put the code we wrote to make one
of the panel figures into a function that we will use in future episodes
to recreate this entire plot with a single line of code.</p>
<div class="codewrapper sourceCode" id="cb41">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a><span class="kw">def</span> plot_pm_selection(df):</span>
<span id="cb41-2"><a href="#cb41-2" tabindex="-1"></a>    <span class="co">"""Plot in GD-1 spatial coordinates the location of the stars</span></span>
<span id="cb41-3"><a href="#cb41-3" tabindex="-1"></a><span class="co">    selected by proper motion</span></span>
<span id="cb41-4"><a href="#cb41-4" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb41-5"><a href="#cb41-5" tabindex="-1"></a>    x <span class="op">=</span> df[<span class="st">'phi1'</span>]</span>
<span id="cb41-6"><a href="#cb41-6" tabindex="-1"></a>    y <span class="op">=</span> df[<span class="st">'phi2'</span>]</span>
<span id="cb41-7"><a href="#cb41-7" tabindex="-1"></a></span>
<span id="cb41-8"><a href="#cb41-8" tabindex="-1"></a>    plt.plot(x, y, <span class="st">'ko'</span>, markersize<span class="op">=</span><span class="fl">0.3</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb41-9"><a href="#cb41-9" tabindex="-1"></a></span>
<span id="cb41-10"><a href="#cb41-10" tabindex="-1"></a>    plt.xlabel(<span class="st">'phi1 [deg]'</span>)</span>
<span id="cb41-11"><a href="#cb41-11" tabindex="-1"></a>    plt.ylabel(<span class="st">'phi2 [deg]'</span>)</span>
<span id="cb41-12"><a href="#cb41-12" tabindex="-1"></a>    plt.title(<span class="st">'Proper motion selection'</span>, fontsize<span class="op">=</span><span class="st">'medium'</span>)</span>
<span id="cb41-13"><a href="#cb41-13" tabindex="-1"></a></span>
<span id="cb41-14"><a href="#cb41-14" tabindex="-1"></a>    plt.axis(<span class="st">'equal'</span>)</span></code></pre>
</div>
<p>Now our one line plot command is:</p>
<div class="codewrapper sourceCode" id="cb42">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a>plot_pm_selection(selected_df)</span></code></pre>
</div>
</section><section><h2 class="section-heading" id="saving-the-dataframe">Saving the DataFrame<a class="anchor" aria-label="anchor" href="#saving-the-dataframe"></a></h2>
<hr class="half-width"><p>At this point we have run a successful query and cleaned up the
results. This is a good time to save the data. We have already started a
results file called gd1_data.hdf which we wrote <code>results_df</code>
to.</p>
<p>Recall that we chose HDF5 because it is a binary format producing
small files that are fast to read and write and are a cross-language
standard.</p>
<p>Additionally, HDF5 files can contain more than one dataset and can
store metadata associated with each dataset (such as column names or
observatory information, like a FITS header).</p>
<p>We can add to our existing Pandas <code>DataFrame</code> to an HDF5
file by omitting the <code>mode='w'</code> keyword like this:</p>
<div class="codewrapper sourceCode" id="cb43">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a>filename <span class="op">=</span> <span class="st">'gd1_data.hdf'</span></span>
<span id="cb43-2"><a href="#cb43-2" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" tabindex="-1"></a>selected_df.to_hdf(filename, <span class="st">'selected_df'</span>)</span></code></pre>
</div>
<p>Because an HDF5 file can contain more than one Dataset, we have to
provide a name, or “key”, that identifies the Dataset in the file.</p>
<p>We could use any string as the key, but it is generally a good
practice to use a descriptive name (just like your
<code>DataFrame</code> variable name) so we will give the Dataset in the
file the same name (key) as the <code>DataFrame</code>.</p>
<div id="exercise-5-minutes" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-5-minutes" class="callout-inner">
<h3 class="callout-title">Exercise (5 minutes)</h3>
<div class="callout-content">
<p>We are going to need <code>centerline_df</code> later as well. Write
a line of code to add it as a second Dataset in the HDF5 file.</p>
<p>Hint: Since the file already exists, you should <em>not</em> use
<code>mode='w'</code>.</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb44">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a>centerline_df.to_hdf(filename, <span class="st">'centerline_df'</span>)</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<p>We can use <code>getsize</code> to confirm that the file exists and
check the size. <code>getsize</code> returns a value in bytes. For the
size files we’re looking at, it will be useful to view their size in
MegaBytes (MB), so we will divide by 1024*1024.</p>
<div class="codewrapper sourceCode" id="cb45">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a><span class="im">from</span> os.path <span class="im">import</span> getsize</span>
<span id="cb45-2"><a href="#cb45-2" tabindex="-1"></a></span>
<span id="cb45-3"><a href="#cb45-3" tabindex="-1"></a>MB <span class="op">=</span> <span class="dv">1024</span> <span class="op">*</span> <span class="dv">1024</span></span>
<span id="cb45-4"><a href="#cb45-4" tabindex="-1"></a>getsize(filename) <span class="op">/</span> MB</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fl">13.992530822753906</span></span></code></pre>
</div>
<p>If you forget what the names of the Datasets in the file are, you can
read them back like this:</p>
<div class="codewrapper sourceCode" id="cb47">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a><span class="cf">with</span> pd.HDFStore(filename) <span class="im">as</span> hdf:</span>
<span id="cb47-2"><a href="#cb47-2" tabindex="-1"></a>    <span class="bu">print</span>(hdf.keys())</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>['/centerline_df', '/results_df', '/selected_df']</code></pre>
</div>
<div id="context-managers" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="context-managers" class="callout-inner">
<h3 class="callout-title">Context Managers</h3>
<div class="callout-content">
<p>We use a <code>with</code> statement here to open the file before the
print statement and (automatically) close it after. Read more about <a href="https://book.pythontips.com/en/latest/context_managers.html" class="external-link">context
managers</a>.</p>
</div>
</div>
</div>
<p>The keys are the names of the Datasets which makes it easy for us to
remember which <code>DataFrame</code> is in which Dataset.</p>
</section><section><h2 class="section-heading" id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a></h2>
<hr class="half-width"><p>In this episode, we re-loaded the transformed Gaia data we saved from
a previous query.</p>
<p>Then we prototyped the selection process from the Price-Whelan and
Bonaca paper locally using data that we had already downloaded.:</p>
<ul><li><p>We selected stars near the centerline of GD-1 and made a scatter
plot of their proper motion.</p></li>
<li><p>We identified a region of proper motion that contains stars
likely to be in GD-1.</p></li>
<li><p>We used a Boolean <code>Series</code> as a mask to select stars
whose proper motion is in that region.</p></li>
</ul><p>So far, we have used data from a relatively small region of the sky
so that our local dataset was not too big. In the next lesson, we will
write a query that selects stars based on the proper motion limits we
identified in this lesson, which will allow us to explore a larger
region.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul><li>A workflow is often prototyped on a small set of data which can be
explored more easily and used to identify ways to limit a dataset to
exactly the data you want.</li>
<li>To store data from a Pandas <code>DataFrame</code>, a good option is
an HDF5 file, which can contain multiple Datasets.</li>
</ul></div>
</div>
</div>
</section></div> <!-- / div.lesson-content -->
    </main><!-- / main#main-content.main-content --><nav class="bottom-pagination mx-md-4" aria-label="Previous and Next Chapter"><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="03-transform.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="05-select.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="03-transform.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Plotting and Tabular
        </a>
        <a class="chapter-link float-end" href="05-select.html" rel="next">
          Next: Transform and Select...
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
    </nav></div> <!-- / div.primary-content.col-xs-12 -->
<!-- END:   inst/pkgdown/templates/content-instructor.html-->

      </div><!--/div.row-->
      		<footer class="row footer mx-md-3"><hr><div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>

        <a href="https://github.com/datacarpentry/astronomy-python/edit/main/episodes/04-motion.md" class="external-link">Edit on GitHub</a>

	
        | <a href="https://github.com/datacarpentry/astronomy-python/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/datacarpentry/astronomy-python/" class="external-link">Source</a></p>
				<p><a href="https://github.com/datacarpentry/astronomy-python/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:team@carpentries.org">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>

        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.16.12" class="external-link">sandpaper (0.16.12)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.9" class="external-link">pegboard (0.7.9)</a>, and <a href="https://github.com/carpentries/varnish/tree/1.0.6" class="external-link">varnish (1.0.6)</a></p>
			</div>
		</footer></div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "LearningResource",
  "@id": "https://datacarpentry.github.io/astronomy-python/04-motion.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/LearningResource/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries",
  "name": "Plotting and Pandas",
  "creativeWorkStatus": "active",
  "url": "https://datacarpentry.github.io/astronomy-python/04-motion.html",
  "identifier": "https://datacarpentry.github.io/astronomy-python/04-motion.html",
  "dateCreated": "2020-05-11",
  "dateModified": "2024-03-08",
  "datePublished": "2025-08-05"
}

  </script><script>
		feather.replace();
	</script><!-- Matomo --><script>
          var _paq = window._paq = window._paq || [];
          /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
          _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
          _paq.push(["setDomains", ["*.lessons.carpentries.org","*.datacarpentry.github.io","*.datacarpentry.org","*.librarycarpentry.github.io","*.librarycarpentry.org","*.swcarpentry.github.io", "*.carpentries.github.io"]]);
          _paq.push(["setDoNotTrack", true]);
          _paq.push(["disableCookies"]);
          _paq.push(["trackPageView"]);
          _paq.push(["enableLinkTracking"]);
          (function() {
              var u="https://matomo.carpentries.org/";
              _paq.push(["setTrackerUrl", u+"matomo.php"]);
              _paq.push(["setSiteId", "1"]);
              var d=document, g=d.createElement("script"), s=d.getElementsByTagName("script")[0];
              g.async=true; g.src="https://matomo.carpentries.org/matomo.js"; s.parentNode.insertBefore(g,s);
          })();
        </script><!-- End Matomo Code --></body></html><!-- END:   inst/pkgdown/templates/layout.html-->

